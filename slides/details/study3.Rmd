---
title: "从数据到论文"
author: "姓名"
date: "`r Sys.Date()`"
output: 
  officedown::rdocx_document:
    number_sections: yes
    df_print: kable
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo         = FALSE,
    warning      = FALSE, 
    message      = FALSE,
    fig.width    = 5, 
    fig.asp      = 0.618,
    dpi          = 600,
    fig.showtext = TRUE
)
options(digits = 3)
```


我们的课程目标：用R语言生成一份完整的word分析报告，内容包括读取数据，画出图形以及建立模型。



# 数据

```{r}
library(tidyverse)

rawdat <- haven::read_sav("data/Study 3/Study 3.sav")  
  
sjPlot::view_df(rawdat)
```


```{r}
d <- rawdat %>% 
  rowwise() %>% 
  transmute(
    Mnos        = Mnos,
    #Nostalgia   = mean(c_across(starts_with("nos"))),
    Connect     = mean(c_across(starts_with("con"))),
    Skepticism  = mean(c_across(starts_with("skep"))),
    Support_AI  = mean(c_across(starts_with("Support_AI"))),
    Support_5G  = mean(c_across(starts_with("Support_5G"))),
    enrolAI     = enrolAI,
    enrol5G     = enrol5G
  ) %>% 
  ungroup()

d %>% 
  head() %>% 
  flextable::flextable()
```


```{r}
d %>% 
  summarise(
    across(everything(), list(M = mean, SD = sd))
  ) %>% 
  pivot_longer(
    cols          = everything(),
    names_to      = c("Variables", ".value"),
    names_pattern = "(.*)_(M|SD)"
  )
```


```{r}
d_c <- cor(d)

d_c[lower.tri(d_c)] <- NA

d_c %>% 
  as.data.frame() %>% 
  rownames_to_column(var = "Variables")
```



```{r}
constructs <- c("nos", "con", "skep", "Support_AI", "Support_5G")
constructs %>%
  set_names() %>%
  map(
    ~ rawdat %>%
      summarise(
        alpha = performance::cronbachs_alpha(pick(starts_with(.x)))
      )
  ) %>%
  list_rbind(names_to = "term")
```


